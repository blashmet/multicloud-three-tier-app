---
ignore_git_branch: true

deployments:

  - name: vmware-us-west-1-dev

    modules:
        
        - name: s3_cleanup_lambda
          path: s3_cleanup_lambda.cfn

        - name: dynamo_state_lock
          path: dynamo_state_lock.cfn

        - name: vmware_stack
          path: vmware_stack.tf
          options:
              terraform_backend_config:
                region: us-west-1
              terraform_backend_cfn_outputs:
                bucket: vmware-us-west-1-dev-vmware-stack-tf-state::TerraformStateBucketName
                dynamodb_table: vmware-us-west-1-dev-vmware-stack-tf-state::TerraformStateTableName
    
    regions:
      - us-west-1

      
  - name: vmware-us-east-2-dev

    modules:

        - name: s3_cleanup_lambda
          path: s3_cleanup_lambda.cfn

        - name: dynamo_state_lock
          path: dynamo_state_lock.cfn

        - name: vmware_stack
          path: vmware_stack.tf
          options:
            terraform_backend_config:
              region: us-east-2
            terraform_backend_cfn_outputs:
              bucket: vmware-us-east-2-dev-vmware-stack-tf-state::TerraformStateBucketName
              dynamodb_table: vmware-us-east-2-dev-vmware-stack-tf-state::TerraformStateTableName

    regions:
      - us-east-2